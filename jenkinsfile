pipeline {
    agent any
    environment{
        DOCKER_IMAGE='pipelineimage'
    }
    stages {
        stage('git clone') {
            steps {
                git branch: 'main', credentialsId: 'sample_py', url: 'https://github.com/sathiyarajm/my_project.git'
           }
        }
        stage('docker build image') {
            steps {
                sh 'docker build -t $DOCKER_IMAGE .'
           }
        }
        stage('docker old container delete & make new container') {
            steps {
                sh 'docker rm -f mycontainer || true'
                sh 'docker run --name=mycontainer $DOCKER_IMAGE'
           }
        }
    }
}